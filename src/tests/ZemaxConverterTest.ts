/**
 * Test the ZemaxImporter with real data
 */

import { ZemaxImporter } from '../utils/ZemaxImporter';

// Test data from zemax2yaml.txt (updated with correct image surface)
const testZemaxData = `#	Type	Comment	Radius	Thickness	Material	Coating	Semi-Diameter	Chip Zone	Mech Semi-Dia	Conic	TCE	
0	STANDARD		Infinity	1.000000000000000E+010			0.000000000000000E+000	0.000000000000000E+000	0.000000000000000E+000	0.000000000000000E+000	0.000000000000000E+000
1	STANDARD		5.415324616573791E+001	8.746657850000000E+000	N-SK2	AR	2.922529777011097E+001	0.000000000000000E+000	2.922529777011097E+001	0.000000000000000E+000	0.000000000000000E+000
2	STANDARD		1.525219209401110E+002	5.000000000000000E-001		AR	2.814095403067300E+001	0.000000000000000E+000	2.922529777011097E+001	0.000000000000000E+000	0.000000000000000E+000
3	STANDARD		3.595062445048480E+001	1.400000000000000E+001	N-SK16	AR	2.429581243874023E+001	0.000000000000000E+000	2.429581243874023E+001	0.000000000000000E+000	0.000000000000000E+000
4	STANDARD		Infinity	3.776965890000000E+000	F5		2.129719092350616E+001	0.000000000000000E+000	2.429581243874023E+001	0.000000000000000E+000	0.000000000000000E+000
5	STANDARD		2.226992461800949E+001	1.425305930000000E+001		AR	1.491935256252774E+001	0.000000000000000E+000	2.429581243874023E+001	0.000000000000000E+000	0.000000000000000E+000
6	STANDARD		Infinity	1.242812910000000E+001			1.022883519099984E+001	0.000000000000000E+000	1.022883519099984E+001	0.000000000000000E+000	0.000000000000000E+000
7	STANDARD		-2.568503303046087E+001	3.776965890000000E+000	F5	AR	1.318775848561757E+001	0.000000000000000E+000	1.892956752918213E+001	0.000000000000000E+000	0.000000000000000E+000
8	STANDARD		Infinity	1.083392850000000E+001	N-SK16		1.646812239512184E+001	0.000000000000000E+000	1.892956752918213E+001	0.000000000000000E+000	0.000000000000000E+000
9	STANDARD		-3.698022072863240E+001	5.000000000000000E-001		AR	1.892956752918213E+001	0.000000000000000E+000	1.892956752918213E+001	0.000000000000000E+000	0.000000000000000E+000
10	STANDARD		1.964173340965081E+002	6.858174910000000E+000	N-SK16	AR	2.131076471656027E+001	0.000000000000000E+000	2.164625843268155E+001	0.000000000000000E+000	0.000000000000000E+000
11	STANDARD		-6.714755002373626E+001	5.731453790500000E+001		AR	2.164625843268155E+001	0.000000000000000E+000	2.164625843268155E+001	0.000000000000000E+000	0.000000000000000E+000
12	STANDARD		Infinity	0.000000000000000E+000			2.457053308904182E+001	0.000000000000000E+000	2.457053308904182E+001	0.000000000000000E+000	0.000000000000000E+000`;

export function testZemaxConverter() {
  console.log('üî¨ Testing Zemax to YAML converter...\n');
  
  try {
    // Convert the data
    const convertedYaml = ZemaxImporter.convertToYaml(testZemaxData);
    
    console.log('Conversion successful!\n');
    console.log('üìÑ Generated YAML:');
    console.log('=' .repeat(50));
    console.log(convertedYaml);
    console.log('=' .repeat(50));
    
    // Validate the conversion
    const validation = ZemaxImporter.validateConversion(testZemaxData, convertedYaml);
    
    console.log('\nValidation Results:');
    console.log(`Valid: ${validation.isValid}`);
    if (validation.issues.length > 0) {
      console.log('Issues found:');
      validation.issues.forEach(issue => console.log(`  ‚ö†Ô∏è  ${issue}`));
    } else {
      console.log('  No issues found');
    }
    
  } catch (error) {
    console.error('‚ùå Conversion failed:', error);
  }
}

// Run the test
testZemaxConverter();